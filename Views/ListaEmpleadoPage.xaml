<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Examen1_PM_II.Views.ListaEmpleadoPage"
             xmlns:converters="clr-namespace:Examen1_PM_II.Converters"
             Title="Empleados Registrados"
             BackgroundColor="#EFEFEF">
    <ContentPage.ToolbarItems>
        <ToolbarItem Text="Agregar" Clicked="OnAgregarClicked" IconImageSource="plus.png" />
    </ContentPage.ToolbarItems>

    <ContentPage.Resources>
        <converters:Base64ToImageSourceConverter x:Key="Base64ToImageSourceConverter" />
    </ContentPage.Resources>

    <RefreshView x:Name="RefreshControl" IsRefreshing="{Binding IsBusy}" Refreshing="OnRefreshViewRefreshing">
        <CollectionView x:Name="ListaEmpleados" SelectionMode="None" Margin="10">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Padding="15" 
                           Margin="0, 8, 0, 8" 
                           CornerRadius="10" 
                           BackgroundColor="White"
                           BorderColor="Transparent"
                           HasShadow="False">
                        <Frame.Shadow>
                            <Shadow Brush="Gray" Offset="3,3" Radius="8" Opacity="0.4"/>
                        </Frame.Shadow>
                        <Grid ColumnDefinitions="70, 10, *" RowDefinitions="Auto, Auto, Auto, Auto">

                            <Frame Grid.RowSpan="4"
                                   Padding="0"
                                   CornerRadius="30"
                                   HeightRequest="60"
                                   WidthRequest="60"
                                   IsClippedToBounds="True"
                                   HorizontalOptions="Center"
                                   VerticalOptions="Start"
                                   BorderColor="#03A9F4"
                                   BackgroundColor="Transparent"
                                   HasShadow="False">
                                <Image Source="{Binding Foto, Converter={StaticResource Base64ToImageSourceConverter}}" 
                                       Aspect="AspectFill" 
                                       HeightRequest="60" 
                                       WidthRequest="60"/>
                            </Frame>

                            <VerticalStackLayout Grid.Column="2" Spacing="5" Margin="0,5,0,0">

                                <Label Text="{Binding Nombre}" 
                                       FontSize="Medium" 
                                       FontAttributes="Bold" 
                                       TextColor="#333333"/>

                                <HorizontalStackLayout Spacing="5">
                                    <Label Text="{Binding Puesto}" 
                                           FontSize="Small" 
                                           TextColor="#03A9F4" 
                                           FontAttributes="Italic"/>
                                    <Label Text="|" 
                                           FontSize="Small" 
                                           TextColor="#AAAAAA"/>
                                    <Label Text="{Binding Correo}" 
                                           FontSize="Small" 
                                           TextColor="#666666"/>
                                </HorizontalStackLayout>

                                <HorizontalStackLayout Spacing="5">
                                    <Label Text="Ingreso:" 
                                           FontSize="Small" 
                                           FontAttributes="Bold" 
                                           TextColor="#666666"/>
                                    <Label Text="{Binding Fecha_ingreso, StringFormat='{0:dd/MM/yyyy}'}" 
                                           FontSize="Small" 
                                           TextColor="#333333"/>
                                </HorizontalStackLayout>
                            </VerticalStackLayout>

                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </RefreshView>
</ContentPage>